% C----------------------------------------------------------------
%       SUBROUTINE PMUT1_CombiIgg (rjd,cor_x,cor_y,cor_ut1)
% C
% C    This subroutine provides, in time domain, the diurnal/subdiurnal
% C    tidal effets on polar motion ("), UT1 (s). The tidal terms,
% C    listed in the program come frome a combined solution of GPS and
% C    VLBI observations of the years 1994.0-2007.0 (more details can be
% C    found in a paper submitted to Journal of Geodesy in 2011:
% C    Artz, Bernhard, Nothnagel, Steigenberger, Tesmer 'Methodology for
% C    the Combination of Sub-daily Earth Rotation from GPS and VLBI 
% C    Observations'
% C    
% C    N.B.:  The fundamental lunisolar arguments are those of Simon et al.  
% C
% C    These corrections should be added to "average"
% C    EOP values to get estimates of the instantaneous values.
% C
% C     PARAMETERS ARE :
% C     rjd      - epoch of interest given in mjd
% C     cor_x    - tidal correction in x (sec. of arc)
% C     cor_y    - tidal correction in y (sec. of arc)
% C     cor_ut1  - tidal correction in UT1-UTC (sec. of time)
% C
% C     modified by T. Artz (2011) to operate on pro- and retrograde PM
% C        coefficients
% C     coded by Ch. Bizouard (2002), initially coded by McCarthy and 
% C     D.Gambis(1997) for the 8 prominent tidal waves.
%   Coded for VieVS:
%   07 Feb 2012 by Lucia Plank
% *************************************************************************


function [cor_x,cor_y,cor_ut1] = eophf_combi(rjd)      


%   Oceanic tidal terms present in x (microas),y(microas),ut1(microseconds)       
%   NARG(j,6) : Multipliers of GMST+pi and Delaunay arguments. 
% 	
%       NARG(j,1),NARG(j,2),NARG(j,3),NARG(j,4),NARG(j,5),NARG(j,6),
%       PMSIN(j),PMCOS(j),UTSIN(j),UTCOS(j),j=1,nlines)/

     NARG=[...
      3,-1, 0,-3, 0,-3,   1.63,  -0.83,   0.00,   0.00
     -1,-1, 0,-2, 0,-2,   0.00,   0.00,   0.10,   0.09
      2,-1, 0,-2, 0,-1,   0.45,  -0.45,   0.00,   0.00
     -2, 0, 0, 3, 0, 3,  -2.13,  -1.90,   0.00,   0.00
      2, 1, 0, 0, 0, 0,  -1.76,   0.07,   0.00,   0.00
      2, 1, 0, 0, 0,-1,  -0.77,   0.04,   0.00,   0.00
      2, 0, 0,-2, 0,-2, -70.07,  38.70,   0.00,   0.00
     -2, 2, 0, 2, 2, 2,   1.07,   1.68,   0.02,  -0.19
      1, 0, 0, 0, 2, 0,   0.26,  -2.81,   0.00,   0.00
      1, 0, 0,-2, 0, 0,  -0.28,   0.77,   0.00,   0.00
      1, 1, 0, 0,-2, 0,  -0.86,   1.81,   0.00,   0.00
     -1, 0, 0, 2, 2, 2,  -0.01,  -0.00,  -0.83,  -0.29
     -2, 0, 0, 2, 2, 2,   8.69,   1.64,   0.51,  -0.83
     -1, 1, 0, 0, 0, 0,   0.00,   0.00,   0.86,   0.75
     -1, 0, 0,-2, 0,-2,   0.01,  -0.00,   0.74,   0.29
     -1, 0, 0,-1, 0,-1,   0.00,   0.00,   0.34,  -0.26
      2,-1, 0,-2, 2,-2,   0.49,  -0.08,   0.00,   0.00
     -1,-1, 0, 0, 0, 0,   0.00,   0.00,   1.29,   0.42
     -2, 0, 0, 1, 0, 1,  -1.13,  -3.00,   0.02,  -0.14
     -1, 0, 0,-2, 2,-2,   0.00,   0.00,   0.18,  -0.14
      1, 0, 0,-2, 2,-2,  25.07, -47.39,   0.00,   0.00
     -1, 0, 0,-2, 0, 0,   0.00,   0.00,   0.12,   0.02
     -1, 2, 0, 2, 0, 1,   0.00,   0.00,  -0.18,   0.08
      1, 0, 0,-2, 0,-2,  48.82,-132.91,   0.00,   0.00
      1, 1, 0,-2, 0,-2,   1.57,   4.64,   0.00,   0.00
      2, 0,-1,-2, 2,-2,  -2.84,   1.62,   0.00,   0.00
     -1,-2, 0, 0, 0, 0,   0.00,   0.00,   0.29,   0.29
     -1, 2, 0, 0, 0, 0,   0.00,   0.00,  -0.09,   0.11
     -2,-1, 0, 2, 2, 2,   8.71,   0.26,   0.70,  -0.30
      2,-1, 0, 0, 0, 0,  -1.76,   0.02,   0.00,   0.00
      1, 0, 1,-2, 2,-2,  -0.22,   0.42,   0.00,   0.00
      2, 0, 0, 0, 0,-2,  -0.24,   0.18,   0.00,   0.00
      1, 0, 0,-3, 0,-3,   3.51,  -1.40,   0.00,   0.00
      2, 0, 0,-2, 0,-1,   2.42,  -0.97,   0.00,   0.00
     -1, 1, 0, 2, 0, 2,  -0.00,  -0.00,  -5.52,  -2.57
      2,-1, 0,-2,-2,-2,  -0.32,   0.85,   0.00,   0.00
     -1, 0, 1, 0, 0, 0,   0.00,   0.00,   0.74,  -0.01
     -2,-1, 0, 0, 0, 1,   1.04,  -1.20,   0.06,   0.02
     -1, 3, 0, 2, 0, 2,   0.00,   0.00,  -0.24,   0.00
     -1, 0,-1, 2, 0, 2,   0.00,   0.00,   0.40,  -0.05
      1, 0, 0,-2,-2,-2,   0.45,  -4.15,   0.00,   0.00
      2, 0, 1,-2,-2,-2,  -0.12,   0.18,   0.00,   0.00
     -2, 2, 0, 2,-2, 2,  -0.78,  -0.00,  -0.16,  -0.06
      2, 0, 0, 0, 0, 1,   0.10,   0.01,   0.00,   0.00
     -2, 1, 0, 0, 0, 0,   1.88,  -0.42,   0.21,  -0.19
      1, 0, 0, 0,-2,-1,   2.02,  -0.62,   0.00,   0.00
      2,-2, 0,-2, 0,-2,  -1.37,   2.37,   0.00,   0.00
     -2, 0, 0, 2, 0, 1, -10.15,  -0.08,  -0.43,   0.19
      2,-1, 1,-2, 0,-2,  -0.12,   0.11,   0.00,   0.00
      1, 1, 0,-2, 0,-1,   0.28,   0.86,   0.00,   0.00
     -1, 1, 0, 0,-2, 1,   0.00,   0.00,  -0.06,  -0.24
      1,-1, 0, 0, 0,-1,  -0.90,   1.93,   0.00,   0.00
     -1, 1, 0, 0, 0, 1,   0.00,   0.00,   0.17,   0.15
     -1, 0, 0, 2, 2, 1,   0.00,   0.00,  -0.22,  -0.07
     -2, 1,-1, 2, 0, 2,   0.42,   0.01,   0.17,   0.21
      2, 0, 0, 0, 0,-1,  -2.28,   1.73,   0.00,   0.00
     -2,-1, 0, 2, 0, 2,  -5.84,   1.56,  -0.36,   0.31
     -1,-1, 0, 2, 2, 2,   0.00,   0.00,  -0.91,  -0.47
      2, 1, 0,-2,-2,-2,  -2.30,   2.15,   0.00,   0.00
      2, 0, 1,-2, 2,-2,   2.46,  -2.33,   0.00,   0.00
     -1, 1, 0, 0,-2, 0,   0.00,   0.00,   0.15,  -0.02
      1, 0, 0, 0, 0, 0, -88.31, 155.33,   0.00,   0.00
     -2, 0, 0, 2, 2, 1,  -1.81,  -1.30,   0.00,   0.00
      1, 0, 0,-2, 2,-1,  -0.29,   0.58,   0.00,   0.00
      2,-2, 0,-2, 2,-2,   0.20,  -0.11,   0.00,   0.00
     -1,-1, 0, 2, 0, 1,   0.00,   0.00,   0.00,   0.17
      2, 0, 0, 0, 0, 0,  -7.70,   5.78,   0.00,   0.00
      2, 1, 0,-2, 0,-2,   1.88,  -0.22,   0.00,   0.00
      1,-1, 0, 0, 0, 0,  -4.48,   9.61,   0.00,   0.00
     -2, 3, 0, 2, 0, 2,   0.37,  -0.29,   0.09,  -0.01
      1, 0, 0, 0, 0,-2,   0.23,  -0.44,   0.00,   0.00
     -2, 0, 0, 2, 0, 2, 252.84, -12.24,  15.07,  -9.23
      1,-1, 0,-2,-2,-2,   3.04,  -1.39,   0.00,   0.00
     -1, 0, 1, 2,-2, 2,   0.00,   0.00,  -0.44,  -0.44
      2, 0, 1,-2, 0,-2,   0.94,   1.07,   0.00,   0.00
      1, 1, 0, 2, 0, 1,  -0.02,   0.38,   0.00,   0.00
     -2, 0,-1, 2, 2, 2,   1.29,  -0.98,   0.05,  -0.01
      2,-1, 0,-2, 0,-2, -11.99,  12.04,   0.00,   0.00
     -2, 0, 0, 0, 0,-1,  -0.39,   0.24,  -0.03,  -0.00
     -2, 1, 1, 2, 0, 2,  -2.07,   2.40,   0.10,   0.04
      1, 0, 0, 0, 0, 1,   1.33,  -2.89,   0.00,   0.00
     -1, 0, 0, 2, 0, 0,   0.00,   0.00,   0.09,   0.07
     -1, 1, 0, 2, 2, 2,   0.00,   0.00,  -0.26,   0.05
      1, 0, 0, 0, 0,-1, -11.99,  21.05,   0.00,   0.00
     -1,-1, 0, 0, 2, 0,   0.00,   0.00,  -0.01,  -0.04
     -1, 0, 0, 0, 2, 0,   0.00,   0.00,  -0.06,   0.27
      1,-2, 0, 0, 0, 0,  -3.60,  -0.17,   0.00,   0.00
     -3, 1, 0, 3, 0, 3,   0.00,   0.00,   0.06,  -0.09
     -2, 1, 0, 2,-2, 2,   0.13,  -0.48,  -0.11,   0.03
     -1, 0,-1, 2,-2, 2,   0.00,   0.00,   0.05,   0.03
     -1, 0, 0,-2, 0,-1,   0.00,   0.00,   0.56,   0.18
      1, 1, 0, 2, 0, 2,  -0.03,   0.59,   0.00,   0.00
     -2, 0, 1, 2, 0, 2,  -0.90,   0.01,   0.12,  -0.03
     -1, 0, 0, 1, 0, 1,   0.00,   0.00,   0.28,  -0.34
      2,-1,-1,-2, 0,-2,   0.10,  -0.11,   0.00,   0.00
     -2, 0, 2, 2,-2, 2,   1.61,   0.08,  -0.01,   0.13
      1, 0,-1, 0, 0, 0,  17.22,  -7.42,   0.00,   0.00
      1,-2, 0,-2, 0,-2,   0.30,  -3.42,   0.00,   0.00
      1, 1, 0, 0, 0, 0,  -6.15,   9.02,   0.00,   0.00
     -1, 0,-1, 0, 0, 0,   0.00,   0.00,   0.27,  -0.19
     -1, 0, 0, 0, 0, 2,   0.00,   0.00,  -0.05,  -0.03
     -2, 1, 0, 0,-2, 0,  -0.40,  -1.56,  -0.17,  -0.04
     -2, 0, 0, 0, 0, 1,   9.61,  -5.29,   0.63,   0.01
     -2, 0, 0, 0, 0, 0,  32.31, -17.60,   1.76,   0.06
      2, 0, 0,-2,-2,-2,  -1.68,   2.75,   0.00,   0.00
     -2, 0, 1, 2,-2, 2,   2.72,  -3.04,   0.07,   0.66
     -1, 2, 0, 2, 0, 2,   0.00,   0.00,  -1.13,   0.10
     -1, 0, 0, 3, 0, 3,   0.00,   0.00,  -0.13,  -0.15
     -2, 0, 0, 0,-2, 0,   0.00,   0.00,  -0.02,   0.43
      1, 0,-1,-2, 2,-2,  -2.54,  -0.98,   0.00,   0.00
      2, 0, 0, 2, 0, 2,   1.52,   1.29,   0.00,   0.00
      1,-1, 0,-2, 0,-1,   0.84,  -6.29,   0.00,   0.00
     -2,-1, 0, 0, 0, 0,   2.40,  -2.74,   0.15,   0.04
      1, 0, 0, 0,-2, 0,  -0.66,   1.72,   0.00,   0.00
      1,-1, 0,-2, 2,-2,   1.18,  -1.55,   0.00,   0.00
      1, 0, 0,-2, 0,-1,   9.22, -25.06,   0.00,   0.00
      1, 0, 1,-2, 0,-2,  -1.60,  -3.60,   0.00,   0.00
     -1,-1, 0, 2, 2, 1,   0.00,   0.00,  -0.40,  -0.20
      2,-1, 0, 0, 0,-1,  -0.78,   0.01,   0.00,   0.00
      2, 0, 0,-2, 2,-2, -22.86,   3.35,   0.00,   0.00
     -2,-1,-1, 2, 2, 2,   0.41,   0.02,  -0.15,   0.08
     -2, 0,-1, 2, 0, 2,   0.80,  -0.02,  -0.14,   0.19
     -2, 0, 0, 2,-2, 2, 103.49, -73.65,   7.52,  -1.11
      1,-2, 0,-2, 0,-1,   0.06,  -0.64,   0.00,   0.00
     -1,-1, 0, 0, 0, 1,   0.00,   0.00,   0.27,   0.08
     -2, 1, 0, 2, 0, 2,  42.54,   0.56,   3.32,  -1.98
     -3, 0, 0, 3, 0, 3,   0.00,   0.00,   0.08,  -0.07
     -1, 0, 1, 2, 0, 2,   0.00,   0.00,  -1.09,  -0.98
      1, 0, 0, 2, 0, 1,  -3.13,   3.39,   0.00,   0.00
      3, 0, 0,-1, 0,-1,   1.87,  -1.87,   0.00,   0.00
     -2, 1, 0, 2, 0, 1,  -1.67,  -0.04,  -0.14,   0.06
     -1, 0, 0, 0, 0,-1,   0.00,   0.00,  -0.43,  -0.44
     -2, 0, 0, 0, 2, 0,   1.89,  -0.90,   0.00,   0.00
     -1, 0, 0, 2, 0, 1,   0.00,   0.00,  -3.38,  -2.31
     -1, 2, 0, 2,-2, 2,   0.00,   0.00,   0.12,   0.18
     -2, 1, 0, 0, 0, 1,   0.83,  -0.19,   0.05,  -0.01
     -2,-1, 0, 0, 2, 0,   0.00,   0.00,  -0.06,  -0.16
      1, 0, 1, 0, 0, 0,  -0.61,   1.19,   0.00,   0.00
      1, 0, 0, 2,-2, 2,  -1.09,   2.11,   0.00,   0.00
     -1,-1, 0,-2, 0,-1,   0.00,   0.00,   0.03,   0.04
     -1, 1, 0, 2, 0, 1,   0.00,   0.00,  -1.09,  -0.32
      1,-1, 0, 0, 2, 0,  -2.40,   3.42,   0.00,   0.00
     -3, 0, 0, 1, 0, 1,   1.24,   1.91,   0.00,   0.00
     -1, 0, 0, 2,-2, 1,   0.00,   0.00,   0.06,   0.04
     -1, 0, 0, 2, 0, 2,  -0.00,  -0.00, -17.80, -12.80
      1,-1, 0,-2, 0,-2,   4.34, -33.32,   0.00,   0.00
     -1, 1, 0, 2,-2, 2,   0.00,   0.00,   0.29,   0.29
      2, 0,-1,-2, 0,-2,   0.23,  -0.12,   0.00,   0.00
      2,-3, 0,-2, 0,-2,  -0.13,   0.34,   0.00,   0.00
      1, 0, 0, 2, 0, 0,  -0.66,   0.71,   0.00,   0.00
     -2, 1, 0, 2, 2, 2,   3.24,   0.53,   0.00,  -0.27
      1, 1, 0,-2,-2,-2,   1.28,  -4.99,   0.00,   0.00
     -1, 0, 0, 0, 0, 1,   0.00,   0.00,   2.43,   1.23
     -2, 0, 0,-2, 0,-1,  -1.34,  -1.38,   0.00,   0.00
      1,-1, 0, 0, 2,-1,   3.26,  -1.07,   0.00,   0.00
     -1, 0, 0, 0,-2, 0,   0.00,   0.00,   0.26,   0.04
     -2, 0, 0, 0, 0, 2,   0.99,  -0.60,   0.07,   0.00
      2, 1, 1,-2,-2,-2,  -0.11,   0.09,   0.00,   0.00
     -1, 0, 0, 2,-2, 2,   0.00,   0.00,  -5.51,  -3.10
     -2, 0,-1, 2,-2, 2,  -5.55,   2.65,  -0.35,  -0.37
      1, 0, 0, 2, 0, 2,  -4.90,   5.30,   0.00,   0.00
      1, 0, 0,-2,-2,-1,   0.08,  -0.78,   0.00,   0.00
      1, 2, 0, 0, 0, 0,  -1.69,   2.76,   0.00,   0.00
     -2, 2, 0, 2, 0, 2,   8.42,  -0.35,   0.63,  -0.39
      1, 1, 0, 0, 0,-1,  -1.22,   1.79,   0.00,   0.00
     -1,-1, 0, 2, 0, 2,   0.00,   0.00,   0.16,   0.31
      1, 1, 0,-2,-2,-1,   0.24,  -0.94,   0.00,   0.00
     -1, 1, 0, 1, 0, 1,   0.00,   0.00,  -0.25,   0.05
     -1,-1, 0, 0, 2, 1,   0.00,   0.00,  -0.04,  -0.22
     -1, 0, 0, 0, 0, 0,   0.00,   0.00,  17.93,   9.14
     -2, 0, 0,-2, 0,-2,   2.26,  -1.40,   0.05,   0.02];

% ------------------------
% TIME VECTOR
% ------------------------ 
      T = (rjd - 51544.5D0)/36525.0D0;  %! julian century

%  Arguments in the following order : chi=GMST+pi,l,lp,F,D,Omega
%  et leur derivee temporelle 

% ------------------------
% FUNDAMENTAL ARGUMENTS
% ------------------------
      
ARG = fund_arg(T,3); % [rad]

% --------------------------
%  CALCULATE CORRECTIONS
% --------------------------
    
PMSIN = NARG(:,7);PMCOS = NARG(:,8);
UTSIN = NARG(:,9);UTCOS = NARG(:,10);

    arg  = NARG (:,1:6)*ARG';
    arg  = mod (arg,2*pi);


    cor_x   = -PMCOS'  * cos(arg) + PMSIN'  * sin(arg);
    cor_y   =  PMSIN'  * cos(arg) + PMCOS'  * sin(arg);
    cor_ut1 =  UTCOS' * cos(arg)  + UTSIN' * sin(arg);

% ------------
%  OUTPUT
% ------------     
    cor_x   = cor_x'   * 1.0d-6;     %    arcsecond (")
    cor_y   = cor_y'   * 1.0d-6;     %    arcsecond (")
    cor_ut1 = cor_ut1' * 1.0d-6;     %    second (s)

